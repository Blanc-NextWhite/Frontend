<div id="lobby-join-information" class="sheet"
  ng-if="lobbyPage.lobbyJoinInformation.game">
  <md-button ng-click="lobbyPage.joinTF2Server()">Connect to server</md-button>
  <span flex>{{::lobbyPage.lobbyJoinInformation.connectString}}</span>
  <md-button data-clipboard-text="{{::lobbyPage.lobbyJoinInformation.connectString}}" class="clipboard-button">Copy to clipboard</md-button>
</div>

<div id="slots">
  <div class="classes-title">
    <h1>Blu</h1>
    <h1>Red</h1>
  </div>
  <div ng-repeat="class in lobbyPage.lobbyInformation.classes track by class.class" class="class-row">
    <div aria-label="Join {{::key}} {{::class.class | classNameFilter}}"
      ng-repeat="(key, slot) in class track by key"
      ng-if="key!='class'"
      ng-click="slot.player ? angular.noop() : lobbyPage.join(lobbyPage.lobbyInformation.id, key, class.class)"
      ng-class="{'sheet low clickable' : !slot.player}"
      class="slot-button"
      md-ink-ripple>
      <div ng-show="slot.filled">
        <md-menu>
          <md-button class="more-button"
            ng-click="slot.player ? $mdOpenMenu($event) : lobbyPage.join(lobbyPage.lobbyInformation.id, key, class.class)">
            <img src="/assets/img/icon-more.svg">
          </md-button>
          <md-menu-content width="4">
            <md-menu-item>
              <md-button ng-click="lobbyPage.goToProfile(slot.player.steamid)">
                Steam profile
              </md-button>
            </md-menu-item>
            <md-menu-item ng-if="$root.userProfile.steamid==lobbyPage.lobbyInformation.leader.steamid || $root.userProfile.role=='administrator'">
              <md-button ng-click="lobbyPage.kick(slot.player)">
                Kick player from slot
              </md-button>
            </md-menu-item>
            <md-menu-item ng-if="$root.userProfile.steamid==lobbyPage.lobbyInformation.leader.steamid || $root.userProfile.role=='administrator'">
              <md-button ng-click="lobbyPage.ban(slot.player)">
                Ban player from lobby
              </md-button>
            </md-menu-item>
            <md-menu-item ng-if="$root.userProfile.steamid==slot.player.steamid">
              <md-button ng-click="lobbyPage.leaveSlot()">
                Leave slot
              </md-button>
            </md-menu-item>
          </md-menu-content>
        </md-menu>
        <md-checkbox ng-checked="slot.ready" aria-label="Player ready" ng-show="lobbyPage.lobbyInformation.state==2"></md-checkbox>
      </div>
      <div flex class="slot-info" ng-show="slot.filled">
        <span class="slot-playername">{{::slot.player.name}}</span>
        <div class="slot-misc">
          <div><span>{{::slot.player.lobbiesPlayed}}</span><span>lobbies</span></div>
        </div>
      </div>
      <img ng-show="slot.filled" ng-src="{{::slot.player.avatar.replace('.jpg', '_medium.jpg') | trusted}}" class="slot-avatar">
    </div>
    <div class="class-button lobby-icon-{{::class.class | classNameFilter}}"></div>
  </div>
</div>